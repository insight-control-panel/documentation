<!DOCTYPE HTML>
<html>
<head>
   <title>Operating Manual &gt; New Download</title>
   <meta name="generator" content="Help & Manual">
   <meta name="keywords" content="">
   <meta name="description" content="New Download">
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <link type="text/css" href="default.css" rel="stylesheet">
   <link type="text/css" href="custom.css" rel="stylesheet">
   <script type="text/javascript" src="nsh.js"></script>

<script type="text/javascript">   
// Toggle Toggler 

var toggleCount=false;
var switchState;

function toggleToggles() {

    if (!toggleCount) {
     toggleCount = true;
     HMToggleExpandAll(true);
     switchState = true;
     }
   
     else if (switchState) {
        HMToggleExpandAll(false);
        switchState = false;
        }
        
     else  {
        HMToggleExpandAll(true);
        switchState = true;
        } 
    }
</script>
   
<!-- non-scrolling headers for CHM and browser-based help, local styles-->
<style type="text/css" media="screen"> 
html, body {    
      margin:0; 
      padding:0; 
      overflow: hidden; 
      background: #FFFFFF; 
   }
 
div#printheader { 
   display: none;
   }
   #idheader { 
      width:100%; 
      height:auto; 
      padding: 0; 
      margin: 0; 
} 
    #idheaderbg  {
    background: #6F6F6F; 
}
   #callout-table, #overview-table {display:block; position:relative; top:0; left:0;}
   #callout-icon {display:block; position:absolute; top:-11px; left:-11px;}
   #callout-icon-flag {display:block; position:absolute; top:-11px; left:-8px;}
   #callout-table a {text-decoration: none; color: blue;}
   #callout-table a:visited {text-decoration: none; color: blue;}
   #overview-table a {text-decoration: none; color: black;}
   #overview-table a:visited {text-decoration: none; color: black;}
   #callout-table a:hover, #overview-table a:hover {text-decoration: underline;}
   p.help-url { margin: 20px 0 5px 0; text-align: center; font-size: 80%; text-decoration: none }
   .sync-toc { color: #ffffff; font-size: 8pt; font-weight: bold; display: none; }
   .sync-toc a { color: #ffffff; text-decoration: none; font-weight: bold;}
   .sync-toc a:visited { color: #ffffff; }
   .sync-toc a:hover { text-decoration: underline; }
   </style>
<!--[if lt IE 7]>
<style type="text/css">
  #idcontent {padding: 0px;} 
  #innerdiv {padding: 10px 5px 5px 10px ;} 
</style> 
<![endif]-->
   <noscript>
   <style type="text/css">
   html, body { overflow: auto; }
   </style> 
   </noscript>
<style type="text/css" media="print">
span.f_Heading1 { color: black; }
#idheader, #printheader img { display:none; }
#printheader { display: block; margin-top: 20px; }
#idcontent { margin-top: 10px; }
</style>   
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "new_download.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body>
<!--ZOOMSTOP-->


<div id="printheader"><h1 class="p_Heading1"><span class="f_Heading1">New Download</span></h1>
</div>
<div id="idheader">
<div id="idheaderbg">
<table width="100%" border="0" cellspacing="0" cellpadding="0" 
       style="margin: 0px; background: url(header_bg.jpg);">

  <tr valign="bottom">
    <td align="left" valign="bottom" class="topichead">
   <p class="sync-toc">&lt;&lt; <a rel="nofollow" href="index.html?new_download.htm" target="_top">Click to Display Table of Contents</a> &gt;&gt;</p>
   <p class="crumbs" id="idnav"><b>Navigation:</b>&nbsp;
   
   <a href="operating_manual.htm">Operating Manual</a>&nbsp;&gt;</p>
   <h1 class="p_Heading1"><span class="f_Heading1">New Download</span></h1>

    </td>
    <td align="right" width="120" valign="middle" class="topichead" id="idnav">
    
     <a href="activate_update-mechanism_2.htm"
        onmouseover="document.images.prev.src='btn_prev_h.gif'" 
        onmouseout="document.images.prev.src='btn_prev_n.gif'"
        ><img name=prev src="btn_prev_n.gif" border=0 alt="Previous page"
        ></a><a href="operating_manual.htm"
        onmouseover="document.images.main.src='btn_home_h.gif'" 
        onmouseout="document.images.main.src='btn_home_n.gif'"><img name=main src="btn_home_n.gif" border=0 alt="Return to chapter overview"
        ></a><a href="massdata.htm"
        onmouseover="document.images.next.src='btn_next_h.gif'" 
        onmouseout="document.images.next.src='btn_next_n.gif'"><img name=next src="btn_next_n.gif" border=0 alt="Next page"
        ></a>
    </td>
  </tr>
  <tr><td colspan="2" style="height: 3px; background: url(header_bg_shadow.gif)"></td></tr>
</table>
</div>

<!-- The following code displays Expand All/Collapse All links  below the header in topics containing toggles -->
  

</div>  



<div id="idcontent"><div id="innerdiv"> 
<!--ZOOMRESTART-->
<p>With release 14 the download mechanism was fully revised.</p>
<p>The now obsolete <span class="f_CodeExample">insight-download</span> is deprecated and should be removed from the deployments directory.</p>
<p>The now obsolete table <span class="f_CodeExample">DownloadData</span> in database <span class="f_CodeExample">tempdb</span> can be dropped.</p>
<p><span style="font-weight: bold;">insight-properties forwarding to insight-download must be deleted.</span></p>
<p class="p_heading1"><span class="f_heading1">Deployment</span></p>
<p class="p__GiS_Std"><span class="f__GiS_Std">Download functionality is now (in preparation for scalability requirements) distributed to multiple applications, so multiple deployments are required.</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:8pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_CodeExample">crawl</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:8pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_CodeExample">download</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:8pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_CodeExample">download-gateway</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:8pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_CodeExample">download-schedule</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:8pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_CodeExample">insight-change-events</span></td></tr></table></div><p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f__GiS_Std">The&nbsp;default&nbsp;bulk&nbsp;size&nbsp;(that&nbsp;is&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;datasets&nbsp;downloaded&nbsp;per&nbsp;request)&nbsp;is&nbsp;100.</span><br />
<span class="f__GiS_Std">In&nbsp;the&nbsp;case&nbsp;you&nbsp;must&nbsp;control&nbsp;the&nbsp;bulksize,&nbsp;set&nbsp;the&nbsp;environment&nbsp;variable</span><span class="f_CodeExample">&nbsp;DEFAULT_BULK_SIZE&nbsp;</span><span class="f__GiS_Std">to&nbsp;the&nbsp;respective&nbsp;value.</span></p>
<p class="p_heading1"><span class="f_heading1">CacheDuration</span></p>
<p>A tree configuration's <span class="f_CodeExample">download</span> section can contain a <span class="f_CodeExample">cacheDuration</span>.</p>
<p>If set, downloads will be held in database cache for the given amount of time.</p>
<p>&nbsp;</p>
<p class="p__GiS_Codeexample"><span class="f__GiS_Codeexample">&quot;name&quot;: &quot;some-tree&quot;,</span><br />
<span class="f__GiS_Codeexample">&quot;download&quot;: {</span><br />
<span class="f__GiS_Codeexample"> &nbsp; &nbsp;&quot;mode&quot;: &quot;auto&quot;,</span><br />
<span class="f__GiS_Codeexample"> &nbsp; &nbsp;&quot;cacheDuration&quot;: &quot;2 hours&quot;</span><br />
<span class="f__GiS_Codeexample">},</span></p>
<p>&nbsp;</p>
<p>While duration notation in ISO-8601 Format is supported (e.g. PT15M for 15 minutes), these values are hard to write and read. The recommended format is &quot;<span style="font-style: italic;">number space unit</span>&quot; as shown in the example, where number is integral and unit is out of <span class="f_CodeExample">days, hours, minutes</span>.</p>
<p class="p_heading1"><span class="f_heading1">Scheduling</span></p>
<p>Downloads can be calculated in advance. So, when clients request a download, it can be delivered immediately. Calculation in advance is achieved by the help of so called <span style="font-style: italic;">schedule plans</span>.</p>
<p>&nbsp;</p>
<p>If a tree is to be calculated in advance, its configuration's <span class="f_CodeExample">download</span> section must name the schedule plan.</p>
<p>&nbsp;</p>
<p class="p__GiS_Codeexample"><span class="f__GiS_Codeexample">&quot;name&quot;: &quot;my-tree&quot;,</span><br />
<span class="f__GiS_Codeexample">&quot;download&quot;: {</span><br />
<span class="f__GiS_Codeexample"> &nbsp; &nbsp;&quot;mode&quot;: &quot;auto&quot;,</span><br />
<span class="f__GiS_Codeexample"> &nbsp; &nbsp;&quot;schedule&quot;: &quot;nightly&quot;</span><br />
<span class="f__GiS_Codeexample">},</span><br />
<span class="f__GiS_Codeexample">&quot;root&quot;: {</span><br />
<span class="f__GiS_Codeexample"> &nbsp; &nbsp;....</span></p>
<p>&nbsp;</p>
<p>This way tree <span class="f_CodeExample">my-tree</span> is configured to be calculated in advance at a schedule with name <span class="f_CodeExample">nightly</span>. Multiple trees can follow the same schedule plan. If a tree should follow multiple schedule plans, list notation can be used.</p>
<p>&nbsp;</p>
<p class="p__GiS_Codeexample"><span class="f__GiS_Codeexample">&quot;name&quot;: &quot;your-tree&quot;,</span><br />
<span class="f__GiS_Codeexample">&quot;download&quot;: {</span><br />
<span class="f__GiS_Codeexample"> &nbsp; &nbsp;&quot;schedule&quot;: [&quot;planA&quot;, &quot;planB&quot;]</span><br />
<span class="f__GiS_Codeexample">},</span></p>
<p>&nbsp;</p>
<p>For scheduled downloads there is no need to configure any <span class="f_CodeExample">cacheDuration</span>.</p>
<p>&nbsp;</p>
<p>Configuring the names of schedule plans, a tree should follow, is necessary, but not sufficient. The actual scheduling is still to be defined.</p>
<p>Schedule plans are defined by insight properties prefixed with <span class="f_CodeExample">&quot;schedule.&quot; </span>Schedule plan <span class="f_CodeExample">nightly</span> from the example above could be defined like so:</p>
<p>&nbsp;</p>
<p class="p__GiS_Codeexample"><span class="f__GiS_Codeexample">#insight properties</span><br />
<span class="f__GiS_Codeexample">schedule.nightly=every day; at 03:00</span></p>
<p>&nbsp;</p>
<p>Daily and weekly intervals are supported. The rules are best explained by examples:</p>
<p>&nbsp;</p>
<p class="p__GiS_Codeexample"><span class="f__GiS_Codeexample">#insight properties</span><br />
<span class="f__GiS_Codeexample">schedule.nightly=every day; at 03:00</span><br />
<span class="f__GiS_Codeexample">schedule.planA=every day; but Saturday; at 21:30</span><br />
<span class="f__GiS_Codeexample">schedule.planB=every day; but Saturday,Sunday; at 22:35</span><br />
<span class="f__GiS_Codeexample">schedule.planC=every Monday; at 05:45</span></p>
<p>&nbsp;</p>
<p>After modifying or adding schedule plans, <span class="f_CodeExample">download-schedule</span> has to be restarted in order to obey the changed plans.</p>
<p>&nbsp;</p>
<p class="p_heading3"><span class="f_heading3">Download for each relevant User-Profile</span></p>
<p><span class="f_CodeExample">download-schedule</span> will cause downloading all trees with the given schedule plan at the respective schedule. Not that obvious is how many exemplars of a tree will be downloaded.</p>
<p>&nbsp;</p>
<p>It depends on two factors, how many exemplars of a tree will be downloaded - the <a href="queryparams.htm" class="topiclink">queryParams</a> and who was logged in. queryParams divide application data in <span style="font-style: italic;">equivalence classes</span>. For each equivalence class, a user was logged in for, a download of that tree will be calculated.</p>
<p>Example: Given a tree with a single queryParam <span style="font-style: italic;">site</span> and given that all formerly logged in users' site is either <span style="font-style: italic;">HD</span> or <span style="font-style: italic;">WHM</span>. Then two exemplars will be downloaded: site=HD and site=WHM. When a user later requests the download, that of the user's site will be delivered.</p>
<p>&nbsp;</p>
<p>Warning: Careless configuration of schedule plans can lead to huge download data with heavy load associated to it. It's generally a bad idea to associate schedule plans to <span style="font-style: italic;">personal</span> trees (trees that have login in its queryParams), or to trees with <span style="font-style: italic;">list-ish</span> queryParams (queryParam whose values are lists), because the number of equivalence classes can be very high.</p>
<p class="p_heading1"><span class="f_heading1">Deleting unwanted downloads</span></p>
<p class="p__GiS_Std"><span class="f__GiS_Std">If downloads are cached due to a set cacheDuration, they will persist until their expiration date is reached. This expiration date is calculated at download time. If a configuration gets changed and you want to get rid of the now obsolete cached downloads, you can delete them in your browser.at </span><span class="f_Hyperlink">http://localhost:8080/download/admin</span></p>
<p class="p_heading1"><span class="f_heading1">Incorporating incremental changes</span></p>
<p><span class="f__GiS_fett">Currently this feature is only supported for Maximo backends</span></p>
<p>&nbsp;</p>
<p>Calculating downloads in advance has one drawback: data accuracy. Changes that were made between the precalculation and the request time are not reflected within the download. So called <span style="font-style: italic;">delta changes</span> help to mitigate the problem. Instead of downloading the entire content again, only the changes since the most recent schedule are calculated an incorporated into the download. This way, data can be kept accurate without causing heavy load and/or bandwith.</p>
<p>&nbsp;</p>
<p>This mechanism is limited by the fact, that only changes within <span style="font-weight: bold;">root objects</span> of the tree are considered. Furthermore the launchpoint of the root type, that propagates changes to insight middleware, must be activated.</p>
<p>&nbsp;</p>
<p>In order to provide and incorporate incremental changes the following applications must be deployed:</p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:8pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_CodeExample">insight-reconciler</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:8pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_CodeExample">insight-recent-changes</span></td></tr></table></div>
<!--ZOOMSTOP-->
</div></div>
<script type="text/javascript">

var lastSlashPos = document.URL.lastIndexOf("/") > document.URL.lastIndexOf("\\") ? document.URL.lastIndexOf("/") : document.URL.lastIndexOf("\\");
if( document.URL.substring(lastSlashPos + 1, lastSlashPos + 4).toLowerCase() != "~hh" )
{
 if (document.all) setTimeout(function() {nsrInit();},20); 
    else nsrInit();
 } 

if ((!parent.hmNavigationFrame) && (parent.location) && (parent.location.href)) { $('.sync-toc').show();$('p.crumbs').hide();}

</script>
</body>
</html>







